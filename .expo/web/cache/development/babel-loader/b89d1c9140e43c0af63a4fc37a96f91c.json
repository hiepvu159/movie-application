{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { InterruptionModeAndroid, InterruptionModeIOS } from \"./Audio.types\";\nimport ExponentAV from \"./ExponentAV\";\nexport * from \"./Audio/Recording\";\nexport * from \"./Audio/Sound\";\nexport { setIsEnabledAsync } from \"./Audio/AudioAvailability\";\nexport { PitchCorrectionQuality } from \"./AV\";\n\nvar _populateMissingKeys = function _populateMissingKeys(userAudioMode, defaultAudioMode) {\n  for (var key in defaultAudioMode) {\n    if (!userAudioMode.hasOwnProperty(key)) {\n      userAudioMode[key] = defaultAudioMode[key];\n    }\n  }\n\n  return userAudioMode;\n};\n\nvar defaultMode = {\n  allowsRecordingIOS: false,\n  interruptionModeIOS: InterruptionModeIOS.MixWithOthers,\n  playsInSilentModeIOS: false,\n  staysActiveInBackground: false,\n  interruptionModeAndroid: InterruptionModeAndroid.DuckOthers,\n  shouldDuckAndroid: true,\n  playThroughEarpieceAndroid: false\n};\nvar currentAudioMode = null;\n\nfunction getCurrentAudioMode() {\n  if (!currentAudioMode) {\n    return defaultMode;\n  }\n\n  return currentAudioMode;\n}\n\nexport function setAudioModeAsync(_x) {\n  return _setAudioModeAsync.apply(this, arguments);\n}\n\nfunction _setAudioModeAsync() {\n  _setAudioModeAsync = _asyncToGenerator(function* (partialMode) {\n    var mode = _populateMissingKeys(partialMode, getCurrentAudioMode());\n\n    if (!InterruptionModeIOS[mode.interruptionModeIOS]) {\n      throw new Error(\"\\\"interruptionModeIOS\\\" was set to an invalid value.\");\n    }\n\n    if (!InterruptionModeAndroid[mode.interruptionModeAndroid]) {\n      throw new Error(\"\\\"interruptionModeAndroid\\\" was set to an invalid value.\");\n    }\n\n    if (typeof mode.allowsRecordingIOS !== 'boolean' || typeof mode.playsInSilentModeIOS !== 'boolean' || typeof mode.staysActiveInBackground !== 'boolean' || typeof mode.shouldDuckAndroid !== 'boolean' || typeof mode.playThroughEarpieceAndroid !== 'boolean') {\n      throw new Error('\"allowsRecordingIOS\", \"playsInSilentModeIOS\", \"playThroughEarpieceAndroid\", \"staysActiveInBackground\" and \"shouldDuckAndroid\" must be booleans.');\n    }\n\n    currentAudioMode = mode;\n    return yield ExponentAV.setAudioMode(mode);\n  });\n  return _setAudioModeAsync.apply(this, arguments);\n}","map":{"version":3,"mappings":";AAAA,SAAoBA,uBAApB,EAA6CC,mBAA7C;AACA,OAAOC,UAAP;AAEA;AACA;AACA,SAASC,iBAAT;AACA,SAASC,sBAAT;;AAEA,IAAMC,oBAAoB,GAAG,SAAvBA,oBAAuB,CAC3BC,aAD2B,EAE3BC,gBAF2B,EAGd;EACb,KAAK,IAAMC,GAAX,IAAkBD,gBAAlB,EAAoC;IAClC,IAAI,CAACD,aAAa,CAACG,cAAd,CAA6BD,GAA7B,CAAL,EAAwC;MACtCF,aAAa,CAACE,GAAD,CAAb,GAAqBD,gBAAgB,CAACC,GAAD,CAArC;IACD;EACF;;EACD,OAAOF,aAAP;AACD,CAVD;;AAYA,IAAMI,WAAW,GAAc;EAC7BC,kBAAkB,EAAE,KADS;EAE7BC,mBAAmB,EAAEX,mBAAmB,CAACY,aAFZ;EAG7BC,oBAAoB,EAAE,KAHO;EAI7BC,uBAAuB,EAAE,KAJI;EAK7BC,uBAAuB,EAAEhB,uBAAuB,CAACiB,UALpB;EAM7BC,iBAAiB,EAAE,IANU;EAO7BC,0BAA0B,EAAE;AAPC,CAA/B;AAUA,IAAIC,gBAAgB,GAAqB,IAAzC;;AAEA,SAASC,mBAAT,GAA4B;EAC1B,IAAI,CAACD,gBAAL,EAAuB;IACrB,OAAOV,WAAP;EACD;;EACD,OAAOU,gBAAP;AACD;;AAOD,gBAAsBE,iBAAtB;EAAA;AAAA;;;yCAAO,WAAiCC,WAAjC,EAAgE;IACrE,IAAMC,IAAI,GAAGnB,oBAAoB,CAACkB,WAAD,EAAcF,mBAAmB,EAAjC,CAAjC;;IAEA,IAAI,CAACpB,mBAAmB,CAACuB,IAAI,CAACZ,mBAAN,CAAxB,EAAoD;MAClD,MAAM,IAAIa,KAAJ,wDAAN;IACD;;IACD,IAAI,CAACzB,uBAAuB,CAACwB,IAAI,CAACR,uBAAN,CAA5B,EAA4D;MAC1D,MAAM,IAAIS,KAAJ,4DAAN;IACD;;IACD,IACE,OAAOD,IAAI,CAACb,kBAAZ,KAAmC,SAAnC,IACA,OAAOa,IAAI,CAACV,oBAAZ,KAAqC,SADrC,IAEA,OAAOU,IAAI,CAACT,uBAAZ,KAAwC,SAFxC,IAGA,OAAOS,IAAI,CAACN,iBAAZ,KAAkC,SAHlC,IAIA,OAAOM,IAAI,CAACL,0BAAZ,KAA2C,SAL7C,EAME;MACA,MAAM,IAAIM,KAAJ,CACJ,iJADI,CAAN;IAGD;;IACDL,gBAAgB,GAAGI,IAAnB;IACA,aAAatB,UAAU,CAACwB,YAAX,CAAwBF,IAAxB,CAAb;EACD,C","names":["InterruptionModeAndroid","InterruptionModeIOS","ExponentAV","setIsEnabledAsync","PitchCorrectionQuality","_populateMissingKeys","userAudioMode","defaultAudioMode","key","hasOwnProperty","defaultMode","allowsRecordingIOS","interruptionModeIOS","MixWithOthers","playsInSilentModeIOS","staysActiveInBackground","interruptionModeAndroid","DuckOthers","shouldDuckAndroid","playThroughEarpieceAndroid","currentAudioMode","getCurrentAudioMode","setAudioModeAsync","partialMode","mode","Error","setAudioMode"],"sourceRoot":"","sources":["../src/Audio.ts"],"sourcesContent":["import { AudioMode, InterruptionModeAndroid, InterruptionModeIOS } from './Audio.types';\nimport ExponentAV from './ExponentAV';\n\nexport * from './Audio/Recording';\nexport * from './Audio/Sound';\nexport { setIsEnabledAsync } from './Audio/AudioAvailability';\nexport { PitchCorrectionQuality } from './AV';\n\nconst _populateMissingKeys = (\n  userAudioMode: Partial<AudioMode>,\n  defaultAudioMode: AudioMode\n): AudioMode => {\n  for (const key in defaultAudioMode) {\n    if (!userAudioMode.hasOwnProperty(key)) {\n      userAudioMode[key] = defaultAudioMode[key];\n    }\n  }\n  return userAudioMode as AudioMode;\n};\n\nconst defaultMode: AudioMode = {\n  allowsRecordingIOS: false,\n  interruptionModeIOS: InterruptionModeIOS.MixWithOthers,\n  playsInSilentModeIOS: false,\n  staysActiveInBackground: false,\n  interruptionModeAndroid: InterruptionModeAndroid.DuckOthers,\n  shouldDuckAndroid: true,\n  playThroughEarpieceAndroid: false,\n};\n\nlet currentAudioMode: AudioMode | null = null;\n\nfunction getCurrentAudioMode(): AudioMode {\n  if (!currentAudioMode) {\n    return defaultMode;\n  }\n  return currentAudioMode;\n}\n\n/**\n * We provide this API to customize the audio experience on iOS and Android.\n * @param partialMode\n * @return A `Promise` that will reject if the audio mode could not be enabled for the device.\n */\nexport async function setAudioModeAsync(partialMode: Partial<AudioMode>): Promise<void> {\n  const mode = _populateMissingKeys(partialMode, getCurrentAudioMode());\n\n  if (!InterruptionModeIOS[mode.interruptionModeIOS]) {\n    throw new Error(`\"interruptionModeIOS\" was set to an invalid value.`);\n  }\n  if (!InterruptionModeAndroid[mode.interruptionModeAndroid]) {\n    throw new Error(`\"interruptionModeAndroid\" was set to an invalid value.`);\n  }\n  if (\n    typeof mode.allowsRecordingIOS !== 'boolean' ||\n    typeof mode.playsInSilentModeIOS !== 'boolean' ||\n    typeof mode.staysActiveInBackground !== 'boolean' ||\n    typeof mode.shouldDuckAndroid !== 'boolean' ||\n    typeof mode.playThroughEarpieceAndroid !== 'boolean'\n  ) {\n    throw new Error(\n      '\"allowsRecordingIOS\", \"playsInSilentModeIOS\", \"playThroughEarpieceAndroid\", \"staysActiveInBackground\" and \"shouldDuckAndroid\" must be booleans.'\n    );\n  }\n  currentAudioMode = mode;\n  return await ExponentAV.setAudioMode(mode);\n}\n"]},"metadata":{},"sourceType":"module"}